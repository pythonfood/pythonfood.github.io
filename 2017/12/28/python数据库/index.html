<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>python数据库 | PythonFood</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="python food,Python Food," />
  
  <meta name="description" content="人生苦短，我用python。">
<meta name="keywords" content="python">
<meta property="og:type" content="article">
<meta property="og:title" content="python数据库">
<meta property="og:url" content="http://pythonfood.github.io/2017/12/28/python数据库/index.html">
<meta property="og:site_name" content="PythonFood">
<meta property="og:description" content="人生苦短，我用python。">
<meta property="og:updated_time" content="2018-03-23T08:43:46.085Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="python数据库">
<meta name="twitter:description" content="人生苦短，我用python。">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>
  

  
  

</head>

<body>
  <div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">Python Food</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a  href="/">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </a>
                    
                    <a  href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>Archives</span>
                    </a>
                    
                    <a  href="/about">
                        <i class="fa fa-user"></i>
                        <span>About</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        Python Food
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        A snake that grows up slowly
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="Home" target="_blank" href="//pythonfood.github.io">
                            <i class="fa fa-home fa-2x"></i></a>
                    
                        <a title="Github" target="_blank" href="//github.com/pythonfood">
                            <i class="fa fa-github fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-python数据库" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      python数据库
    </h1>
    <div class="post-title-bar">
      <ul>
          
              <li>
                  <i class="fa fa-book"></i>
                  
                      <a href="/categories/python/">python</a>
                  
              </li>
          
        <li>
          <i class="fa fa-calendar"></i>  2017-12-28
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <p>人生苦短，我用python。<br><a id="more"></a></p>
<h2 id="一、pymysql模块"><a href="#一、pymysql模块" class="headerlink" title="一、pymysql模块"></a>一、pymysql模块</h2><p>PyMySQL是在Python3.x版本中用于连接MySQL服务器的一个库。</p>
<h3 id="1、pymysql安装"><a href="#1、pymysql安装" class="headerlink" title="1、pymysql安装"></a>1、pymysql安装</h3><p>(1)pip命令安装</p>
<blockquote>
<p><code>pip install PyMySQL</code></p>
</blockquote>
<p>(2)git命令下载安装</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/PyMySQL/PyMySQL</span><br><span class="line">$ cd PyMySQL/</span><br><span class="line">$ python3 setup.py install</span><br></pre></td></tr></table></figure>
</blockquote>
<p>(3)curl命令制定版本号</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ curl -L https://github.com/PyMySQL/PyMySQL/tarball/pymysql-X.X | tar xz</span><br><span class="line">$ cd PyMySQL* # 安装完可以删除PyMySQL*目录</span><br><span class="line">$ python3 setup.py install</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="2、数据库连接"><a href="#2、数据库连接" class="headerlink" title="2、数据库连接"></a>2、数据库连接</h3><p>使用数据库之前确保创建了数据库testdb，用户名”root”，密码”123456”。</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">#1.使用connect()方法连接数据库</span><br><span class="line">db = pymysql.connect(&apos;localhost&apos;, &apos;root&apos;, &apos;123456&apos;, &apos;testdb&apos;)</span><br><span class="line"></span><br><span class="line">#2.使用cursor()方法创建游标对象</span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">#3.使用execute()方法执行SQL语句</span><br><span class="line">cursor.execute(&apos;SELECT VERSION()&apos;)</span><br><span class="line"></span><br><span class="line">#4.使用fetchone()方法获取表单数据</span><br><span class="line">data = cursor.fetchone()</span><br><span class="line"></span><br><span class="line">print(&quot;Database version : s%&quot; % data)</span><br><span class="line"></span><br><span class="line">#5.使用close()方法关闭数据库连接</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="3、创建数据库表"><a href="#3、创建数据库表" class="headerlink" title="3、创建数据库表"></a>3、创建数据库表</h3><p><code>execute()</code>方法执行sql语句为数据库创建表。</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">#1.使用connect()方法连接数据库</span><br><span class="line">db = pymysql.connect(&apos;localhost&apos;, &apos;root&apos;, &apos;123456&apos;, &apos;testdb&apos;)</span><br><span class="line"></span><br><span class="line">#2.使用cursor()方法创建游标对象</span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">#3.如果user表已经存在，先删除</span><br><span class="line">cursor.execute(&quot;DROP TABLE IF EXISTS user&quot;)</span><br><span class="line"></span><br><span class="line">#4.使用预处理语句创建user表</span><br><span class="line">sql = &quot;&quot;&quot;CREATE TABLE user(</span><br><span class="line">		 NAME CHAR(20) NOT NULL,</span><br><span class="line">		 AGE INT,</span><br><span class="line">		 SEX CHAR(1),</span><br><span class="line">		 INCOME FLOAT)&quot;&quot;&quot;</span><br><span class="line">cursor.execute(sql)</span><br><span class="line"></span><br><span class="line">#5.使用close()方法关闭数据库连接</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="4、数据库插入操作"><a href="#4、数据库插入操作" class="headerlink" title="4、数据库插入操作"></a>4、数据库插入操作</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">#1.使用connect()方法连接数据库</span><br><span class="line">db = pymsql.connect(&apos;localhost&apos;, &apos;root&apos;, &apos;123456&apos;, &apos;testdb&apos;)</span><br><span class="line"></span><br><span class="line">#2.使用cursor()方法创建游标对象</span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">#3.sql插入语句</span><br><span class="line">sql = &quot;&quot;&quot;INSERT INTO user(NAME,AGE,SEX,INCOME)</span><br><span class="line">		 VALUES(&apos;Jac&apos;,&apos;20&apos;,&apos;M&apos;,2000)&quot;&quot;&quot;</span><br><span class="line">		 </span><br><span class="line">#4.执行sql插入操作</span><br><span class="line">try:</span><br><span class="line">	cursor.execute(sql)</span><br><span class="line">	db.commit() #注意：提交到数据库执行</span><br><span class="line">except:</span><br><span class="line">	db.rollback() #注意：如果发生错误则回滚</span><br><span class="line"></span><br><span class="line">#5.使用close()方法关闭数据库连接	</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<p>ps:可以使用变量向SQL语句中传递参数</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">user_id = &quot;test1&quot;</span><br><span class="line">password = &quot;123456&quot;</span><br><span class="line"></span><br><span class="line">con.execute(&apos;insert into Login values(&quot;%s&quot;, &quot;%s&quot;)&apos; % \</span><br><span class="line">             (user_id, password))</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="5、数据库删除操作"><a href="#5、数据库删除操作" class="headerlink" title="5、数据库删除操作"></a>5、数据库删除操作</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">#1.使用connect()方法连接数据库</span><br><span class="line">db = pymsql.connect(&apos;localhost&apos;, &apos;root&apos;, &apos;123456&apos;, &apos;testdb&apos;)</span><br><span class="line"></span><br><span class="line">#2.使用cursor()方法创建游标对象</span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">#3.sql删除语句</span><br><span class="line">sql = &quot;DELETE FROM user WHERE AGE &gt; &apos;%d&apos;&quot; % (20)</span><br><span class="line"></span><br><span class="line">#4.执行sql删除操作</span><br><span class="line">try:</span><br><span class="line">	cursor.execute(sql)</span><br><span class="line">	db.commite() #注意：提交到数据库执行</span><br><span class="line">except:</span><br><span class="line">	db.rollback() #注意：如果发生错误则回滚</span><br><span class="line"></span><br><span class="line">#5.使用close()方法关闭数据库连接	</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="6、数据库更新操作"><a href="#6、数据库更新操作" class="headerlink" title="6、数据库更新操作"></a>6、数据库更新操作</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">#1.使用connect()方法连接数据库</span><br><span class="line">db = pymysql.connect(&apos;localhost&apos;, &apos;root&apos;, &apos;123456&apos;,&apos;testdb&apos;)</span><br><span class="line"></span><br><span class="line">#2.使用cursor()方法创建游标对象</span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">#3.sql删除语句</span><br><span class="line">sql = &quot;UPDATE user SET AGE = AGE + 1 WHERE SEX = &apos;%c&apos;&quot; % (&apos;W&apos;)</span><br><span class="line"></span><br><span class="line">#4.执行sql删除操作</span><br><span class="line">try:</span><br><span class="line">	cursor.execute(sql)</span><br><span class="line">	db.commite() #注意：提交到数据库执行</span><br><span class="line">except:</span><br><span class="line">	db.rollback() #注意：如果发生错误则回滚</span><br><span class="line">	</span><br><span class="line">#5.使用close()方法关闭数据库连接	</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="7、数据库查询操作"><a href="#7、数据库查询操作" class="headerlink" title="7、数据库查询操作"></a>7、数据库查询操作</h3><p>使用fetchone()方法获取单条数据, 使用fetchall()方法获取多条数据。</p>
<ul>
<li><code>fetchone()</code>: 该方法获取下一个查询结果集。结果集是一个对象。</li>
<li><code>fetchall()</code>: 接收全部的返回结果行。</li>
<li><code>rowcount</code>: 这是一个只读属性，并返回执行execute()方法后影响的行数。</li>
</ul>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">#1.使用connect()方法连接数据库</span><br><span class="line">db = pymysql.connect(&apos;localhost&apos;, &apos;root&apos;, &apos;123456&apos;, &apos;testdb&apos;)</span><br><span class="line"></span><br><span class="line">#2.使用cursor()方法创建游标对象</span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">#3.sql查询语句</span><br><span class="line">sql = &quot;SELECT * FROM user \</span><br><span class="line">	   WHERE INCOME &gt; &apos;%d&apos;&quot; % (1000)</span><br><span class="line"></span><br><span class="line">#4.执行sql查询操作	   </span><br><span class="line">try:</span><br><span class="line">	cursor.execute(sql)</span><br><span class="line">	results = cursor.fetchall() #查询所有记录列表</span><br><span class="line">	for row in results:</span><br><span class="line">		name = row[0]</span><br><span class="line">		age = row[1]</span><br><span class="line">		sex = row[2]</span><br><span class="line">		income = row[3]</span><br><span class="line">		print(&quot;name=%s,age=%s,sex=%s,income=%d&quot; % \</span><br><span class="line">		(name, age, sex, income)) #打印结果</span><br><span class="line">except:</span><br><span class="line">	print(&apos;Error: unable to fetch data&apos;)</span><br><span class="line">	</span><br><span class="line">#5.使用close()方法关闭数据库连接	</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="8、执行事务"><a href="#8、执行事务" class="headerlink" title="8、执行事务"></a>8、执行事务</h3><p>事务机制可以确保数据一致性。</p>
<p>事务具有4个属性：原子性、一致性、隔离性、持久性。这四个属性通常称为ACID特性。</p>
<ul>
<li>原子性（atomicity）：一个事务是一个不可分割的工作单位，事务中包括的诸操作要么都做，要么都不做。</li>
<li>一致性（consistency）：事务必须是使数据库从一个一致性状态变到另一个一致性状态。一致性与原子性是密切相关的。</li>
<li>隔离性（isolation）：一个事务的执行不能被其他事务干扰。即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。</li>
<li>持久性（durability）：持续性也称永久性（permanence），指一个事务一旦提交，它对数据库中数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其有任何影响。 </li>
</ul>
<p>Python DB API 2.0的事务提供了两个方法<code>commit()</code>或<code>rollback()</code>。</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sql = &quot;DELETE FROM user WHERE INCOME &gt; &apos;%d&apos;&quot; % (1000)</span><br><span class="line">try:</span><br><span class="line">   cursor.execute(sql) # 执行SQL语句</span><br><span class="line">   db.commit()# commit() # 方法游标的所有更新操作</span><br><span class="line">except:</span><br><span class="line">   db.rollback() # rollback() # 方法回滚当前游标的所有操作</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="9、错误处理"><a href="#9、错误处理" class="headerlink" title="9、错误处理"></a>9、错误处理</h3><table>
<thead>
<tr>
<th style="text-align:left">异常</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Warning</td>
<td style="text-align:left">当有严重警告时触发，例如插入数据是被截断等等。必须是 StandardError 的子类。</td>
</tr>
<tr>
<td style="text-align:left">Error</td>
<td style="text-align:left">警告以外所有其他错误类。必须是 StandardError 的子类。</td>
</tr>
<tr>
<td style="text-align:left">InterfaceError</td>
<td style="text-align:left">当有数据库接口模块本身的错误（而不是数据库的错误）发生时触发。 必须是Error的子类。</td>
</tr>
<tr>
<td style="text-align:left">DatabaseError</td>
<td style="text-align:left">和数据库有关的错误发生时触发。 必须是Error的子类。</td>
</tr>
<tr>
<td style="text-align:left">DataError</td>
<td style="text-align:left">当有数据处理时的错误发生时触发，例如：除零错误，数据超范围等等。 必须是DatabaseError的子类。</td>
</tr>
<tr>
<td style="text-align:left">OperationalError</td>
<td style="text-align:left">指非用户控制的，而是操作数据库时发生的错误。例如：连接意外断开、 数据库名未找到、事务处理失败、内存分配错误等等操作数据库是发生的错误。 必须是DatabaseError的子类。</td>
</tr>
<tr>
<td style="text-align:left">IntegrityError</td>
<td style="text-align:left">完整性相关的错误，例如外键检查失败等。必须是DatabaseError子类。</td>
</tr>
<tr>
<td style="text-align:left">InternalError</td>
<td style="text-align:left">数据库的内部错误，例如游标（cursor）失效了、事务同步失败等等。 必须是DatabaseError子类。</td>
</tr>
<tr>
<td style="text-align:left">ProgrammingError</td>
<td style="text-align:left">程序错误，例如数据表（table）没找到或已存在、SQL语句语法错误、 参数数量错误等等。必须是DatabaseError的子类。</td>
</tr>
<tr>
<td style="text-align:left">NotSupportedError</td>
<td style="text-align:left">不支持错误，指使用了数据库不支持的函数或API等。例如在连接对象上 使用.rollback()函数，然而数据库并不支持事务或者事务已关闭。 必须是DatabaseError的子类。</td>
</tr>
</tbody>
</table>
<h2 id="二、sqlite3模块"><a href="#二、sqlite3模块" class="headerlink" title="二、sqlite3模块"></a>二、sqlite3模块</h2><p>SQLite是C写的一种嵌入式数据库，它的数据库就是一个文件，体积很小，经常被集成到各种应用程序中。<br>Python内置SQLite3，使用SQLite不需要安装任何东西，直接使用。</p>
<p>创建数据库的连接，如果数据库不存在，连接对象会自动创建数据库文件；如果数据库存在，则连接对象直接打开该数据库文件。<br>连接对象可以是硬盘上面的数据库文件，也可以是建立在内存中的：</p>
<ul>
<li>创建在硬盘上面： <code>conn = sqlite3.connect(&#39;c:\\test\\test.db&#39;)</code></li>
<li>创建在内存上面： <code>conn = sqlite3.connect(&#39;&quot;memory:&#39;)</code></li>
</ul>
<p>其中conn对象是数据库链接对象，具有以下操作：</p>
<ul>
<li><code>cursor()</code> : 创建一个游标</li>
<li><code>commit()</code> : 事务提交</li>
<li><code>rollback()</code> : 事务回滚</li>
<li><code>close()</code> : 关闭数据库链接</li>
</ul>
<p>创建了一个游标对象 ：<code>cu = conn.cursor()</code>，具有以下具体操作：</p>
<ul>
<li><code>execute()</code> : 执行一条sql语句</li>
<li><code>executemany()</code> : 执行多条sql语句</li>
<li><code>close()</code> : 游标关闭</li>
<li><code>fetchone()</code> : 从结果中取出一条记录</li>
<li><code>fetchmany()</code> : 从结果中取出多条记录</li>
<li><code>fetchall()</code> : 从结果中取出所有记录</li>
<li><code>scroll()</code> : 游标滚动</li>
</ul>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import sqlite3</span><br><span class="line">  </span><br><span class="line">#创建数据库  </span><br><span class="line">conn = sqlite3.connect(&apos;test.db&apos;) </span><br><span class="line">#创建游标 </span><br><span class="line">cur = conn.cursor()  </span><br><span class="line"></span><br><span class="line">#创建数据表</span><br><span class="line">cur.execute(&apos;create table t(id int,v varchar(20));&apos;);   </span><br><span class="line">#数据库操作</span><br><span class="line">cur.execute(&quot;insert into t values(%d,&apos;%s&apos;)&quot; % (1,&apos;xxx&apos;))  </span><br><span class="line">cur.execute(&quot;insert into t values(%d,&apos;%s&apos;)&quot; % (2,&apos;yyy&apos;))    </span><br><span class="line">cur.execute(&quot;update t set v = &apos;%s&apos; where id = %d&quot; % (&apos;zzz&apos;,2))   </span><br><span class="line">cur.execute(&quot;select * from t;&quot;) </span><br><span class="line">#打印结果  </span><br><span class="line">results = cur.fetchall()   </span><br><span class="line">for row in results:  </span><br><span class="line">    print(row)  </span><br><span class="line">#事务提交</span><br><span class="line">conn.commit() </span><br><span class="line"> </span><br><span class="line">#关闭游标 </span><br><span class="line">cur.close() </span><br><span class="line">#关闭数据库连接 </span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="持续更新…"><a href="#持续更新…" class="headerlink" title="持续更新…"></a>持续更新…</h1>
            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2018年03月23日 16:43</p>
        <p>原始链接： <a class="post-url" href="/2017/12/28/python数据库/" title="python数据库">http://pythonfood.github.io/2017/12/28/python数据库/</a></p>
        <footer>
            <a href="http://pythonfood.github.io">
                <img src="/images/logo.png" alt="Python Food">
                Python Food
            </a>
        </footer>
    </div>
</div>

      
        
            
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;">赏</a>
</div>

<div id="reward" class="post-modal reward-lay">
    <a class="close" href="javascript:;" id="reward-close">×</a>
    <span class="reward-title">
        <i class="icon icon-quote-left"></i>
        多少都行~
        <i class="icon icon-quote-right"></i>
    </span>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/images/wechat_code.jpg" alt="打赏二维码">
        </div>
        <div class="reward-select">
            
            <label class="reward-select-item checked" data-id="wechat" data-wechat="/images/wechat_code.jpg">
                <img class="reward-select-item-wechat" src="/images/wechat.png" alt="微信">
            </label>
            
            
            <label class="reward-select-item" data-id="alipay" data-alipay="/images/alipay_code.jpg">
                <img class="reward-select-item-alipay" src="/images/alipay.png" alt="支付宝">
            </label>
            
        </div>
    </div>
</div>


        
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://pythonfood.github.io/2017/12/28/python数据库/&title=《python数据库》 — PythonFood&pic=/images/banner.jpg" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://pythonfood.github.io/2017/12/28/python数据库/&title=《python数据库》 — PythonFood&source=人生苦短，我用python。" data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://pythonfood.github.io/2017/12/28/python数据库/" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《python数据库》 — PythonFood&url=http://pythonfood.github.io/2017/12/28/python数据库/&via=http://pythonfood.github.io" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://pythonfood.github.io/2017/12/28/python数据库/" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://pythonfood.github.io/2017/12/28/python数据库/" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/python/" class="color2">python</a>
      
  </li>

        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一、pymysql模块"><span class="post-toc-text">一、pymysql模块</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1、pymysql安装"><span class="post-toc-text">1、pymysql安装</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2、数据库连接"><span class="post-toc-text">2、数据库连接</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3、创建数据库表"><span class="post-toc-text">3、创建数据库表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4、数据库插入操作"><span class="post-toc-text">4、数据库插入操作</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5、数据库删除操作"><span class="post-toc-text">5、数据库删除操作</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6、数据库更新操作"><span class="post-toc-text">6、数据库更新操作</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7、数据库查询操作"><span class="post-toc-text">7、数据库查询操作</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#8、执行事务"><span class="post-toc-text">8、执行事务</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#9、错误处理"><span class="post-toc-text">9、错误处理</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#二、sqlite3模块"><span class="post-toc-text">二、sqlite3模块</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#持续更新…"><span class="post-toc-text">持续更新…</span></a>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/2018/01/01/selenium安装-windows/" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          selenium安装-windows
        
      </span>
    </a>
  
  
    <a href="/2017/12/28/python发送邮件/" id="article-nav-older" class="article-nav-link-wrap">
      <span class="article-nav-title">python发送邮件</span>
      <i class="fa fa-hand-o-right" aria-hidden="true"></i>
    </a>
  
</nav>



    
        <div id="SOHUCS" sid="python数据库" ></div>
<script type="text/javascript">
    (function(){
        var appid = 'cytnRgqDg';
        var conf = '61714297a608dcad6779ec4ea0059b2a';
        var width = window.innerWidth || document.documentElement.clientWidth;
        if (width < 960) {
            window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>
    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2018 Python Food<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "http://pythonfood.github.io",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/appium/">appium</a><a class="category-link" href="/categories/hexo/">hexo</a><a class="category-link" href="/categories/markdown/">markdown</a><a class="category-link" href="/categories/monkey/">monkey</a><a class="category-link" href="/categories/python/">python</a><a class="category-link" href="/categories/selenium/">selenium</a><a class="category-link" href="/categories/专项测试/">专项测试</a><a class="category-link" href="/categories/持续集成/">持续集成</a><a class="category-link" href="/categories/接口测试/">接口测试</a><a class="category-link" href="/categories/测试框架/">测试框架</a><a class="category-link" href="/categories/测试用例/">测试用例</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/appium/" style="font-size: 14px;">appium</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/monkey/" style="font-size: 10px;">monkey</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/selenium/" style="font-size: 12px;">selenium</a> <a href="/tags/专项测试/" style="font-size: 16px;">专项测试</a> <a href="/tags/持续集成/" style="font-size: 10px;">持续集成</a> <a href="/tags/接口测试/" style="font-size: 14px;">接口测试</a> <a href="/tags/测试框架/" style="font-size: 10px;">测试框架</a> <a href="/tags/测试用例/" style="font-size: 18px;">测试用例</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a  href="/">
                    <i class="fa fa-home"></i><span>Home</span>
                </a>
            </li>
            
            <li>
                <a  href="/archives">
                    <i class="fa fa-archive"></i><span>Archives</span>
                </a>
            </li>
            
            <li>
                <a  href="/about">
                    <i class="fa fa-user"></i><span>About</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/appium/" style="font-size: 14px;">appium</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/monkey/" style="font-size: 10px;">monkey</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/selenium/" style="font-size: 12px;">selenium</a> <a href="/tags/专项测试/" style="font-size: 16px;">专项测试</a> <a href="/tags/持续集成/" style="font-size: 10px;">持续集成</a> <a href="/tags/接口测试/" style="font-size: 14px;">接口测试</a> <a href="/tags/测试框架/" style="font-size: 10px;">测试框架</a> <a href="/tags/测试用例/" style="font-size: 18px;">测试用例</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="/js/search.js"></script>
<script src="/js/main.js"></script>


  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  <script src="/js/particles.js"></script>







  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  <script src="/js/animate.js"></script>

  </div>
</body>
</html>